<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bootstrap Methods for Nested Linear Mixed-Effects Models â€¢ lmeresampler</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Bootstrap Methods for Nested Linear Mixed-Effects Models">
<meta property="og:description" content="Bootstrap routines for nested linear mixed effects models fit using
    either lme4 or nlme. The provided bootstrap() function implements the
    parametric, residual, cases, semi-parametric (i.e., CGR),  and random effect
    block (REB) bootstrap procedures. An overview of these procedures can be found 
    in Van der Leeden et al. (2008) &lt;doi: 10.1007/978-0-387-73186-5_11&gt;, 
    Carpenter, Goldstein &amp; Rasbash (2003) &lt;doi: 10.1111/1467-9876.00415&gt;,
    and Chambers &amp; Chandra (2013) &lt;doi: 10.1080/10618600.2012.681216&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">lmeresampler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.0000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/lmeresampler-vignette.html">Vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/aloy/lmeresampler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="lmeresampler" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#lmeresampler" class="anchor"></a>lmeresampler</h1></div>

<!-- README.md is generated from README.Rmd. Please edit that file -->
<p><img src="image/FINAL_HEX_nobackground.png" width="200"></p>
<p>The <code>lme4</code> and <code>nlme</code> packages have made fitting nested linear mixed-effects models quite easy. Using the functionality of these packages we can easily use maximum likelihood or restricted maximum likelihood to fit our model and conduct inference using our parametric toolkit. In practice, the assumptions of our model are often violated to such a degree that leads to biased estimators and incorrect standard errors. In these situations, resampling methods such as the bootstrap can be used to obtain consistent estimators of the bias and standard errors for inference. <code>lmeresampler</code> provides an easy way to bootstrap nested linear-mixed effects models using either the parametric, residual, cases, CGR (semi-parametric), or random effects block (REB) bootstrap fit using either <code>lme4</code> or <code>nlme</code>. The output from <code>lmeresampler</code> is an <code>lmeresamp</code> object. Moreover, the <code>lmeresampler</code> package has its own <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> and <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code> functions, both of which follow the syntax of a generic <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> and <code><a href="https://rdrr.io/r/stats/confint.html">confint()</a></code> function; thus, the two commands may be used with <code>lmeresamp</code> objects.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the latest released version from CRAN with:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"lmeresampler"</span>)</pre></div>
<p>or the latest development version from GitHub:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="kw">if</span>(!<span class="fu"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="no">devtools</span>)) <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)
<span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"aloy/lmeresampler"</span>)</pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>Below is a short example of how to execute a parametric bootstrap for models fit either by <code>lme4</code> or by <code>nlme</code>. For a complete guide outlining the purpose of <code>lmeresampler</code>, the structure of <code>lmeresamp</code> objects, each of the bootstrap types, how to implement parallelization with <code><a href="reference/bootstrap.html">bootstrap()</a></code> calls, directions for future developers, and examples, please see the package vignette, available on the <code>lmersampler</code> website.</p>
<p>First, fit the necessary model(s) with the LME package of your choice. Here we show the same model fit first with <code>lme4</code>, then with <code>nlme</code>:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lmeresampler</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lme4</span>)
<span class="no">vcmodA</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/lme4/man/lmer.html">lmer</a></span>(<span class="no">mathAge11</span> ~ <span class="no">mathAge8</span> + <span class="no">gender</span> + <span class="no">class</span> + (<span class="fl">1</span> <span class="kw">|</span> <span class="no">school</span>), <span class="kw">data</span> <span class="kw">=</span> <span class="no">jsp728</span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">nlme</span>)
<span class="no">vcmodB</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/nlme/man/lme.html">lme</a></span>(<span class="no">mathAge11</span> ~ <span class="no">mathAge8</span> + <span class="no">gender</span> + <span class="no">class</span>, <span class="kw">random</span> <span class="kw">=</span> ~<span class="fl">1</span><span class="kw">|</span><span class="no">school</span>, <span class="kw">data</span> <span class="kw">=</span> <span class="no">jsp728</span>)</pre></div>
<p>Now, to perform a parametric bootstrap, first specify the model to be used, then the function to return the parameters of interest, then <code>type = "parametric</code>, and finally, the number of bootstrap resamples to be computed:</p>
<div class="sourceCode" id="cb4"><pre class="r"><span class="co"># let's set .f = fixef to specify that we want only the fixed effects bootstrapped</span>

<span class="co"># lme4</span>
<span class="no">lmer_par_boot</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/bootstrap.html">bootstrap</a></span>(<span class="no">vcmodA</span>, <span class="kw">.f</span> <span class="kw">=</span> <span class="no">fixef</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"parametric"</span>, <span class="kw">B</span> <span class="kw">=</span> <span class="fl">100</span>)

<span class="co"># nlme</span>
<span class="no">lme_par_boot</span>  <span class="kw">&lt;-</span> <span class="fu"><a href="reference/bootstrap.html">bootstrap</a></span>(<span class="no">vcmodB</span>, <span class="kw">.f</span> <span class="kw">=</span> <span class="no">fixef</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"parametric"</span>, <span class="kw">B</span> <span class="kw">=</span> <span class="fl">100</span>)</pre></div>
<p>The four other bootstrap types (residual, cases, CGR, and REB) may be executed in a similar way, with some minor changes.</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>A full list of references may be found in the package vignette.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=lmeresampler">https://â€‹cloud.r-project.org/â€‹package=lmeresampler</a>
</li>
<li>Browse source code at <br><a href="https://github.com/aloy/lmeresampler/">https://â€‹github.com/â€‹aloy/â€‹lmeresampler/â€‹</a>
</li>
<li>Report a bug at <br><a href="https://github.com/aloy/lmeresampler/issues">https://â€‹github.com/â€‹aloy/â€‹lmeresampler/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Adam Loy <br><small class="roles"> Author, maintainer </small>  </li>
<li>Spenser Steele <br><small class="roles"> Author </small>  </li>
<li>Jenna Korobova <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/aloy/lmeresampler"><img src="https://travis-ci.org/aloy/lmeresampler.svg?branch=master" alt="Build Status"></a></li>
<li><a href="https://cran.r-project.org/package=lmeresampler"><img src="http://www.r-pkg.org/badges/version/lmeresampler" alt="CRAN_Status_Badge"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Adam Loy, Spenser Steele, Jenna Korobova.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
