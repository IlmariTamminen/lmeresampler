<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Bootstrap Nested Linear Mixed-Effects Models — bootstrap.lmerMod • lmeresampler</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Bootstrap Nested Linear Mixed-Effects Models — bootstrap.lmerMod" />
<meta property="og:description" content="Perform various bootstrap process for nested linear mixed effects (LMEs) models including:
parametric, residual, cases, CGR, and REB bootstraps." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lmeresampler</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0.0000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/lmeresampler-vignette.html">Vignette</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/aloy/lmeresampler/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Bootstrap Nested Linear Mixed-Effects Models</h1>
    <small class="dont-index">Source: <a href='https://github.com/aloy/lmeresampler/blob/master/R/bootstrap_lme4.R'><code>R/bootstrap_lme4.R</code></a>, <a href='https://github.com/aloy/lmeresampler/blob/master/R/bootstrap_nlme.R'><code>R/bootstrap_nlme.R</code></a>, <a href='https://github.com/aloy/lmeresampler/blob/master/R/generics.R'><code>R/generics.R</code></a></small>
    <div class="hidden name"><code>bootstrap.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform various bootstrap process for nested linear mixed effects (LMEs) models including:
parametric, residual, cases, CGR, and REB bootstraps.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for lmerMod</span>
<span class='fu'>bootstrap</span>(<span class='no'>model</span>, <span class='no'>.f</span>, <span class='no'>type</span>, <span class='no'>B</span>, <span class='no'>resample</span>, <span class='no'>reb_type</span>)

<span class='co'># S3 method for lme</span>
<span class='fu'>bootstrap</span>(<span class='no'>model</span>, <span class='no'>.f</span>, <span class='no'>type</span>, <span class='no'>B</span>, <span class='no'>resample</span>, <span class='no'>reb_type</span>)

<span class='fu'>bootstrap</span>(<span class='no'>model</span>, <span class='no'>.f</span>, <span class='no'>type</span>, <span class='no'>B</span>, <span class='kw'>resample</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>reb_type</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>model</th>
      <td><p>The model object you wish to bootstrap.</p></td>
    </tr>
    <tr>
      <th>.f</th>
      <td><p>A function returning the statistic(s) of interest.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>A character string indicating the type of bootstrap that is being
requested. Possible values are <code>"parametric"</code>, <code>"residual"</code>, 
<code>"case"</code>, <code>"cgr"</code>, or <code>"reb"</code> (random effect block bootstrap).</p></td>
    </tr>
    <tr>
      <th>B</th>
      <td><p>The number of bootstrap resamples.</p></td>
    </tr>
    <tr>
      <th>resample</th>
      <td><p>A logical vector specifying whether each level of the model 
should be resampled in the cases bootstrap. The levels should be specified 
from the highest level (largest cluster) of the hierarchy to the lowest 
(observation-level); for example for students within a school, specify the 
school level first, then the student level.</p></td>
    </tr>
    <tr>
      <th>reb_type</th>
      <td><p>Specification of what random effect block bootstrap version to
implement. Possible values are <code>0</code>, <code>1</code> or <code>2</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The returned value is an object of class "lmeresamp".</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>All of the below methods have been implemented for nested linear mixed-effects
models fit by <code>lmer</code> (i.e., an <code>lmerMod</code> object) and <code>lme</code> 
(i.e., an <code>lmerMod</code> object). Details of the bootstrap procedures can be found
in the help file for that specific function.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Carpenter, J. R., Goldstein, H. and Rasbash, J. (2003) A novel bootstrap 
   procedure for assessing the relationship between class size and achievement. 
   <em>Journal of the Royal Statistical Society. Series C (Applied Statistics)</em>, 
   <b>52</b>, 431--443.</p>   
<p>Chambers, R. and Chandra, H. (2013) A random effect block bootstrap for 
   clustered data. <em>Journal of Computational and Graphical Statistics</em>, 
   <b>22</b>, 452--470.</p>   
<p>Morris, J. S. (2002) The BLUPs are not "best" when it comes to bootstrapping. 
   <em>Statistics and Probability Letters</em>, <b>56</b>, 425--430.</p>   
<p>Van der Leeden, R., Meijer, E. and Busing F. M. (2008) Resampling multilevel 
   models. In J. de Leeuw and E. Meijer, editors, <em>Handbook of 
   Multilevel Analysis</em>, pages 401--433. New York: Springer.</p>   
<p>Bates, D., Maechler, M., Bolker, W., Walker, S. (2015).
   Fitting Linear Mixed-Effects Models Using lme4. <em>Journal of
   Statistical Software</em>, <b>67</b>, 1--48. doi:10.18637/jss.v067.i01.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'>
<ul>
<li><p><code><a href='parametric_bootstrap.html'>parametric_bootstrap</a></code>, <code><a href='resid_bootstrap.html'>resid_bootstrap</a></code>,
     <code><a href='case_bootstrap.html'>case_bootstrap</a></code>, <code><a href='cgr_bootstrap.html'>cgr_bootstrap</a></code>, 
     <code><a href='reb_bootstrap.html'>reb_bootstrap</a></code> for more details on a specific bootstrap.</p></li>
<li><p><code><a href='https://rdrr.io/pkg/lme4/man/bootMer.html'>bootMer</a></code> in the <span class="pkg">lme4</span> package for an 
     implementation of (semi-)parameteric bootstrap for mixed models.</p></li>
</ul>
</div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>lme4</span>)</div><div class='output co'>#&gt; <span class='message'>Loading required package: Matrix</span></div><div class='input'><span class='no'>vcmodA</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lme4/man/lmer.html'>lmer</a></span>(<span class='no'>mathAge11</span> ~ <span class='no'>mathAge8</span> + <span class='no'>gender</span> + <span class='no'>class</span> + (<span class='fl'>1</span> <span class='kw'>|</span> <span class='no'>school</span>), <span class='kw'>data</span> <span class='kw'>=</span> <span class='no'>jsp728</span>)

<span class='co'>## you can write your own function to return stats, or use something like 'fixef'</span>
<span class='no'>mySumm</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>.</span>) {
  <span class='no'>s</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/lme4/man/getME.html'>getME</a></span>(<span class='no'>.</span>, <span class='st'>"sigma"</span>)
    <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='kw'>beta</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/lme4/man/getME.html'>getME</a></span>(<span class='no'>.</span>, <span class='st'>"beta"</span>), <span class='kw'>sigma</span> <span class='kw'>=</span> <span class='no'>s</span>, <span class='kw'>sig01</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unname.html'>unname</a></span>(<span class='no'>s</span> * <span class='fu'><a href='https://rdrr.io/pkg/lme4/man/getME.html'>getME</a></span>(<span class='no'>.</span>, <span class='st'>"theta"</span>)))
}

<span class='co'>## running a parametric bootstrap </span>
<span class='fu'><a href='https://rdrr.io/r/base/Random.html'>set.seed</a></span>(<span class='fl'>1234</span>)
<span class='no'>boo1</span> <span class='kw'>&lt;-</span> <span class='fu'>bootstrap</span>(<span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>vcmodA</span>, <span class='kw'>.f</span> <span class='kw'>=</span> <span class='no'>mySumm</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"parametric"</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>)

<span class='kw'>if</span> (<span class='fl'>FALSE</span>) {
<span class='co'>## running a cases bootstrap - only resampling the schools</span>
<span class='no'>boo2</span> <span class='kw'>&lt;-</span> <span class='fu'>bootstrap</span>(<span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>vcmodA</span>, <span class='kw'>.f</span> <span class='kw'>=</span> <span class='no'>mySumm</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"case"</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>resample</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>TRUE</span>, <span class='fl'>FALSE</span>))

<span class='co'>## running a cases bootstrap - resampling the schools and students within the school</span>
<span class='no'>boo2</span> <span class='kw'>&lt;-</span> <span class='fu'>bootstrap</span>(<span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>vcmodA</span>, <span class='kw'>.f</span> <span class='kw'>=</span> <span class='no'>mySumm</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"case"</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>resample</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>TRUE</span>, <span class='fl'>FALSE</span>))

<span class='co'>## running a semi-parametric bootstrap</span>
<span class='no'>boo3</span> <span class='kw'>&lt;-</span> <span class='fu'>bootstrap</span>(<span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>vcmodA</span>, <span class='kw'>.f</span> <span class='kw'>=</span> <span class='no'>mySumm</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"cgr"</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>)

<span class='co'>## running a residual bootstrap</span>
<span class='no'>boo4</span> <span class='kw'>&lt;-</span> <span class='fu'>bootstrap</span>(<span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>vcmodA</span>, <span class='kw'>.f</span> <span class='kw'>=</span> <span class='no'>mySumm</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"residual"</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>)

<span class='co'>## running an REB0 bootstrap</span>
<span class='no'>boo5</span> <span class='kw'>&lt;-</span> <span class='fu'>bootstrap</span>(<span class='kw'>model</span> <span class='kw'>=</span> <span class='no'>vcmodA</span>, <span class='kw'>.f</span> <span class='kw'>=</span> <span class='no'>mySumm</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"reb"</span>, <span class='kw'>B</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>reb_typ</span> <span class='kw'>=</span> <span class='fl'>0</span>)
}

<span class='co'>## to print results in a formatted way</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>boo1</span>)</div><div class='output co'>#&gt; Bootstrap type: parametric 
#&gt; 
#&gt; Number of resamples: 100 
#&gt; 
#&gt;         observed   rep.mean         se          bias
#&gt; beta1 14.1577509 14.0158661 0.65832020 -0.1418848720
#&gt; beta2  0.6388895  0.6429228 0.02436914  0.0040333457
#&gt; beta3 -0.3571922 -0.2909488 0.36701673  0.0662434573
#&gt; beta4  0.7200815  0.7242379 0.39057968  0.0041564090
#&gt; sigma  4.4416279  4.4414617 0.11345797 -0.0001661894
#&gt; sig01  1.8199553  1.7909477 0.24175360 -0.0290075852</div><div class='input'>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Adam Loy, Spenser Steele, Jenna Korobova.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


