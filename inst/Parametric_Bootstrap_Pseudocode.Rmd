---
title: "Parametric Bootstrap Pseudocode"
author: "Spenser Steele"
date: "June 23, 2014"
output: pdf_document
---

Model (1)
===========
$$y_{ij}=\mathbf{x}_{ij}^T\boldsymbol{\beta}+u_i+e_{ij},\quad j=1,\ldots,n_i;i=1,\ldots,D.$$

Information
============
The parametric bootstrap method for the estimates $\hat{\theta}=(\boldsymbol{\hat{\beta}}, \hat{\sigma}_u^{2}, \hat{\sigma}_e^{2})$.

Parametric Bootstrap
====================
1. Generate independent level 2 errors for the $D$ groups as $u_i^*\sim N(0,\hat{\sigma}_u^2)$, $i=1,\ldots, D$.
```
u.star <- rnorm(D, 0, sigma.u^2)
```
2. Generate independent level 1 errors for all $n$ samples units as $e_{ij}^*\sim N(0,\hat{\sigma}_e^2)$, $j=1,\ldots, n_i$.
```
e.star <- rnorm(n_i, 0, sigma.e^2)
```
3. Simulate bootstrap sample data $(y_{ij}^*,\mathbf{x}_{ij})$ using the model $y_{ij}^*=\mathbf{x}_{ij}^T\boldsymbol{\hat{\beta}}+u_i^*+e_{ij}^*$.
4. Fit the two-level random effects model (1) to the bootstrap sample data generated in Step (2) to obtain bootstrap parameter estimates $\hat{\theta}^*=(\boldsymbol{\hat{\beta}}^*, \hat{\sigma}_u^{2*}, \hat{\sigma}_e^{2*})$.
4. Repeat Steps 1-3 $B$ times to obtain $B$ sets of bootstrap parameter estimates.